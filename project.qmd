---
title: "Projectdata"
author: "EL Ghali DEBBAGH and Victoria SEMINA Project"
format: html
editor: visual
---

```{r}
#| message: false
here::i_am("project.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
```

## Datacleaning

```{r}
FAO <- vroom("FAO.csv")
```

```{r}
#We fist had a problem in the FAO databse where some years in column 'Year' were witten as and interval example 2014 was written as 2013-2015 ...


FAO$Year <- ifelse(grepl("\\d{4}-(\\d{4})", FAO$Year), sub("(\\d{4})-(\\d{4})", "\\1", FAO$Year) %>% as.numeric() + 1, FAO$Year)

```

```{r}
# Here we just delete the 'Year code column' since we already have a column year
FAO_test<-
FAO |> select(-`Year Code`)


```

```{r}
#Here we use pivot wider to put our indicators in columns to get our 'final' first table

FAO_widetest<- FAO_test |> pivot_wider(names_from = Item, values_from = Value, id_cols =c('Year', 'Area'))
```

```{r}

WB<- vroom("WB.csv")

```
#In this table the initial problem was having years in columns instead of lines, so first we used pivot longer to make years in lines 
WB_longtest<-WB|>pivot_longer(!(`Country Name` | `Country Code` |`Series Name` |`Series Code`))

```
```{r}
#Here we just recall the new column or years 'Year'
WB_longtest <- WB_longtest |> rename("Year"="name")
```

```{r}
# In the world bank database some missing values were automaticly replaced by ".." so we replace them with NA
WB_longtest[WB_longtest==".."]<- NA
```

```{r}
# Here we had a problem with year columns where years were written 2014[YR2014] ... so we wanted to get only the year and delete the [YR2014] for every year 
WB_longtest$Year <- gsub("\\[.*\\]", "", WB_longtest$Year)
```
```{r}
#Here is the final version of the second second table we use pivot wiedr to make indicators in columns 
WB_wide <- WB_longtest |>
  pivot_wider(
    names_from = `Series Name`,
    values_from = value,
    id_cols = c('Year', 'Country Name'),
    values_fn = list
  )

```
```{r}
#Summary of fist table
num_rows <- nrow(FAO_widetest)
num_cols <- ncol(FAO_widetest)

missing_values <- colSums(is.na(FAO_widetest))

summary_table <- data.frame(
  Number_of_rows = num_rows,
  Number_of_columns = num_cols,
  Number_of_missing_values = missing_values
)


knitr::kable(summary_table)
```
