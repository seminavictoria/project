---
title: "Project: Group 3"
author: "EL Ghali DEBBAGH and Victoria SEMINA Project"
format: pdf
editor: visual
execute: 
  warning: false
  error: false
  echo: false
---

```{r}
#| message: false
#| warning: false
here::i_am("project.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
library(plotly)
library(psych)
library(lmtest)

```

## Research Question

The research question of our project: How do various development indicators, such as national income, investment, and education, interact with and influence the levels of food (in)security within a nation? It seemed to us that it would be relevant to study the relationship between food security and various indicators of the country's development, since this directly affects the overall well-being of the country and the quality of life in it. In addition, we look at both developed and developing countries, which will allow us to identify patterns of inequality. Analyzing the relationships between food security and development outcomes can also highlight inequalities in access to resources and opportunities.

It seemed to us that, in general, the study of food security and its links with various development indicators is important for the scientific community and for our own development, in order to potentially understand how to build a more sustainable, prosperous and international society.

As part of the analysis, we expect that a certain relationship will be found between national income and food security. Specifically, that high national income can be associated with increased access to quality and varied food. However, despite this, food security problems such as malnutrition due to social inequalities may also exist in developed countries.

In addition, we are going to analyze the relationship between education and food security. We expect that higher levels of education will generally be associated with higher levels of healthy eating awareness and resource management skills, which will help improve food security.

We also want to analyze developed and developing countries because we expect different results in these groups. It seems to us that in developed countries the main problems will be related to the social aspects of food security, such as inequality in access to resources. In particular, anorexia and obesity may be problems of overconsumption and pressure from social standards of beauty, while in developing countries, conversely, low levels of education and limited investment may lead to malnutrition and lack of access to key food resources. Overall, through the analysis of the relationships between food security and various development indicators, we want to identify the main dynamics that shape the level of food security in different countries.

## Data Set Description

### Food Security Indicators:

The first data source which we used is FAO (Food and Agriculture Organisation of the United Nations): https://www.fao.org/faostat/en/#data/FS with the data selected from "Suite of Food Security Indicators" (steps to get the final table are: select in countries: "select all", in elements select "values", in items select "prevalence of undernourishment (percent)", "Prevalence of severe food insecurity in the total population (percent)", "Percentage of children under 5 years affected by wasting (percent)", "Percentage of children under 5 years of age who are stunted (modelled estimates) (percent)", "Percentage of children under 5 years of age who are overweight (modelled estimates) (percent)", "Prevalence of obesity in the adult population (18 years and older)", "Prevalence of anemia among women of reproductive age (15-49 years)", "Prevalence of low birthweight (percent)",Â "Prevalence of exclusive breastfeeding among infants 0-5 months of age", for the selected years , we choose to work from 2013 to 2022.

We decided to choose these indicators because, apart from basic nutrition, food security is linked to economic stability, long-term health, women's empowerment and the environment. Research reveals that food insecurity can result in ongoing short and long-term health problems. The first two years of a child's life are of critical importance for their healthy growth and development. For children, severe food insecurity has been linked to chronic health conditions like stunting, wasting and anemia. A diet lacking enough calories, protein, vitamins and minerals will impede a child's growth and development from before they're born up until adolescence. A pregnant mother's malnutration can lead to low birthweight, infant mortality, preterm delivery and slow cognitive development for her baby.

All in all, this suite of food security indicators is composed of a revised selection of indicators based on the SDGs monitoring requirement and data availability. For example, some of the utilization indicators are replaced with official SDGs indicators. Data in this domain are featured in the State of Food Security and Nutrition in the World 2022 report.

```{r}
#| message: false

FAO <- vroom("FAO.csv")
```

```{r}
#First of all, we had a problem with the FAO database because some years in column 'Year' were written as an interval, e.g. 2014 was written as 2013-2015. This problem actually comes from the original FAO website's database description, where years are written as following 2022/2021-2023. So first of all we figured out this issue.


FAO$Year <- ifelse(grepl("\\d{4}-(\\d{4})", FAO$Year), sub("(\\d{4})-(\\d{4})", "\\1", FAO$Year) %>% as.numeric() + 1, FAO$Year)

```

```{r}
# Then we had a need to delete the 'Year code column' since we already have a column year
FAO_test<-
FAO |> select(-`Year Code`)


```

```{r}
#After that, we use 'pivot wider' to put our indicators in columns to get our cleaned first table
FAO_widetest<- FAO_test|> pivot_wider(names_from = Item, values_from = Value, id_cols =c('Year', 'Area'))
```
### World Development Indicators

The second data source is The World Bank where we got the world development indicators (https://databank.worldbank.org/source/world-development-indicators#). To get our final table, we select in database "World Development Indicators", for Countries, we selected all countries from Afghanistan to Zimbabwe, in series we select "GDP growth (annual %)", "GDP per capita growth (annual %)", "Agricultural land (% of land area", "Children in employment, female (% of female children ages 7-14)", "Children in employment, female (% of female children ages 7-14)", "Children in employment, male (% of male children ages 7-14)", "Children out of school (% of primary school age)", "Children out of school, female (% of female primary school age)", "Children out of school, male (% of male primary school age)", "Death rate, crude (per 1,000 people)", "Current education expenditure, total (% of total expenditure in public institutions)", "Current health expenditure (% of GDP)", "Food production index (2014-2016 = 100)","Gini index" ,"Labor force participation rate, female (% of female population ages 15+ (modeled ILO estimate)", "Labor force, female (% of total labor force)", "Life expectancy at birth, total (years)", "Lifetime risk of maternal death (%)", "Number of infant deaths".

World Development Indicators (WDI) is the primary World Bank collection of development indicators, compiled from officially recognized international sources. It presents the most current and accurate global development data available, and includes national, regional and global estimates. Even though Global Development Finance (GDF) is no longer listed in the WDI database name, all external debt and financial flows data continue to be included in WDI. The GDF publication has been renamed International Debt Statistics (IDS), and has its own separate database, as well. The World Bank is known for maintaining high standards in databases. There is data reliability, World Bank data is generally subject to rigorous standards and quality controls. As part of our project, the database from World Bank enable to make international comparisons by collecting data from many countries.

The chosen indicators seem quite obvious; those in the first table mainly concern the percentages of people suffering from diseases, such as anemia, obesity, low birth weight, for the second table the indicators are as common as the first; these are the basic development indicators (GDP and GDP/inhabitant, etc.) as well as indicators on education, in particular the education of women, then indicators on resources and agriculture going to indicators of inequalities like the Gini index.

```{r}
#| message: false

WB<- vroom("WB.csv")
```

```{r}
# Now we are looking at the table from the World Bank. The initial problem there was the fact that years were written in columns instead of lines. That's why we decided to use 'pivot longer' to put years in lines (to combine after with the first table)
WB_longtest<-WB|>pivot_longer(!(`Country Name` | `Country Code` |`Series Name` |`Series Code`))
```

```{r}
#Here we need to name the new column with years as 'Year'
WB_longtest <- WB_longtest |> rename("Year"="name")
```

```{r}
# In the World Bank database some missing values were automatically replaced by ".." In order not to get any problems with working with tables we replace such missed values with NA
WB_longtest[WB_longtest==".."]<- NA
```

```{r}
# After cleaning this, we faced with the another problem with  year columns where years were written as 2014[YR2014]. However, we need to have only the year insteasm so we deleted these brackets for every year 
WB_longtest$Year <- gsub("\\[.*\\]", "", WB_longtest$Year)
```

```{r}
#After that, we use 'pivot wider' to put our indicators in columns to get our cleaned second table
WB_wide <- WB_longtest |>
  pivot_wider(
    names_from = `Series Name`,
    values_from = value,
    id_cols = c('Year', 'Country Name'),
    values_fn = list
  )

```

```{r}
#| message: false

#Summary of the first table
num_rows <- nrow(FAO_widetest)
num_cols <- ncol(FAO_widetest)

missing_values <- colSums(is.na(FAO_widetest))

summary_table <- data.frame(
  Number_of_rows = num_rows,
  Number_of_columns = num_cols,
  Number_of_missing_values = missing_values
)


knitr::kable(summary_table)
```

```{r}
#Summary of the second table

num_rows_wide <- nrow(WB_wide)
num_cols_wide <- ncol(WB_wide)


missing_values_wide <- colSums(is.na(WB_wide))


summary_table_wide <- data.frame(
  Number_of_rows = num_rows_wide,
 Number_of_columns = num_cols_wide,
  Number_of_missing_values = missing_values_wide
)


knitr::kable(summary_table_wide)

```

```{r}
WB_wide <- WB_wide |> 
  rename("Area" = `Country Name` )
```

```{r}
WB_wide <- slice(WB_wide, 1:2170)

```

```{r}
data <- merge(WB_wide, FAO_widetest, by = c("Year", "Area"))
```

```{r}
WB_wide$Year <- trimws(WB_wide$Year)
WB_wide$Area <- trimws(WB_wide$Area)

FAO_widetest$Year <- trimws(FAO_widetest$Year)
FAO_widetest$Area <- trimws(FAO_widetest$Area)

```

```{r}
data <- merge(WB_wide, FAO_widetest, by = c("Year", "Area"), all.x = TRUE, all.y = TRUE)

```

```{r}
#| warning: false


area_column <- data$Area

non_numeric_columns <- sapply(data, function(x) !is.numeric(x))


data[, non_numeric_columns] <- lapply(data[, non_numeric_columns], function(x) as.numeric(as.character(x)))

data <- round(data, 2)

data$Area <- area_column
```
